{
    "blocks": [],
    "contracts": [
        {
            "Name": "hackaton_RateUser",
            "Value": "contract hackaton_RateUser {\n    data {\n        Rate int\n        Id int\n    }\n    \n    conditions {\n        if $Rate < 1 || $Rate > 10 {\n            info \"оценка должна быть от 1 до 10\"\n        }\n        if DBFind(\"hackaton\").Where(\"id=? and rate > 5\", $Id).One(\"id\"){\n            info \"оценка уже есть\"\n        }\n        \n    }\n    action {\n        DBUpdate(\"hackaton\", $Id, \"rate\", $Rate)\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        },
        {
            "Name": "hackaton_StoreUser",
            "Value": "contract hackaton_StoreUser {\n    data {\n        Name string\n        Email string\n        Work string\n    }\n    \n    conditions {\n        $Email = Replace($Email, \" \", \"\")\n        if DBFind(\"hackaton\").Where(\"email=?\", $Email).Row() {\n            info \"Пользователь с такой почтой уже добавлен\"\n        }\n        \n    }\n    action {\n        DBInsert(\"hackaton\", \"name,email,work\", $Name, $Email, $Work)\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")"
        }
    ],
    "data": [],
    "languages": [],
    "menus": [
        {
            "Name": "default_menu",
            "Value": "MenuItem(Title: hackaton, Page: hackaton, Icon:fa fa-list-ul)",
            "Conditions": "ContractConditions(\"MainCondition\")"
        }
    ],
    "pages": [
        {
            "Name": "hackaton",
            "Value": "DBFind(Name:hackaton, Source: src).Order(\"id desc\").Custom(_actions){\n    If(#rate#>0){}.Else{\n        Form(){\n            Div(col-sm-6){\n                Input(Name: Rate, Type: number, Value: GetVar(rate))\n                Input(Name: Id, Type: hidden, Value: #id#)\n            }\n            Div(col-sm-6){\n                Button(Body: rate, Contract: hackaton_RateUser, Class: btn btn-primary, Page: hackaton)\n            }\n        }\n    }\n}.Custom(_source){\n    LinkPage(Class: icon-notebook, Page: hackaton_source, PageParams: \"Id=#id#\")\n}\nDiv(content-wrapper){\n    Div(row){\n        Div(col-sm-8 col-sm-offset-2){\n            Form(panel panel-primary){\n                Div(panel-body){\n                    Div(row){\n                        Div(col-sm-4){Name*}\n                        Div(col-sm-8){Input(Name: Name)}\n                    }\n                    Div(row){\n                        Div(col-sm-4){Email*}\n                        Div(col-sm-8){Input(Name: Email)}\n                    }\n                    Div(row){\n                        Div(col-sm-4){Source*}\n                        Div(col-sm-8){Input(Name: Work, Type: textarea)}\n                    }\n                }\n                Div(panel-footer text-right){\n                    Button(Body: store user, Contract: hackaton_StoreUser, Page: hackaton)\n                }\n            }\n        }\n    }\n    \n    Div(row){\n        Div(col-sm-12){\n            Table(src, \"id,name,email,source=_source,rate,=_actions\")\n        }\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "default_menu"
        },
        {
            "Name": "hackaton_source",
            "Value": "Div(content-wrapper){\n    Div(breadcrumb){\n        Div(){\n            LinkPage(Body:hackaton, Page: hackaton)\n            Span(/).Style(margin-right: 10px;margin-left: 10px;).(source, text-muted)\n        }\n    }\n    If(#Id#>0){\n        DBFind(Name:hackaton, Source: src).Columns(\"work\").Where(\"id=#Id#\").Vars(hacker)\n        Div(row){\n            Div(col-sm-12){\nCode(\n    #hacker_work#\n)\n            }\n        }\n    }.Else{\n        id не передано на страницу\n    }\n}",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Menu": "default_menu"
        }
    ],
    "parameters": [],
    "tables": [
        {
            "Name": "hackaton",
            "Columns": "[\n    {\n        \"name\": \"name\",\n        \"type\": \"text\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"email\",\n        \"type\": \"text\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"work\",\n        \"type\": \"text\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"rate\",\n        \"type\": \"number\",\n        \"conditions\": \"true\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        }
    ]
}